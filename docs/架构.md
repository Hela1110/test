# 购物系统架构设计文档

## 1. 整体架构

### 1.1 系统架构
本系统采用C/S（客户端/服务器）架构，主要分为以下几个部分：
- 客户端：基于Qt6开发的GUI应用程序
- 服务器：基于Java开发的后端服务
- 数据库：MySQL数据库服务器

### 1.2 技术栈
- 客户端：
  - Qt6框架
  - C++17
  - CMake构建系统
- 服务器：
  - Java
  - Spring Boot框架
  - MyBatis ORM框架
- 数据库：
  - MySQL 8.0
- 开发工具：
  - Visual Studio Code
  - Qt Creator
  - MySQL Workbench

## 2. 客户端架构

### 2.1 目录结构
```
client/
├── include/          # 头文件目录
│   ├── chat/        # 聊天相关头文件
│   ├── login/       # 登录相关头文件
│   └── shop/        # 购物相关头文件
├── src/             # 源代码目录
│   ├── chat/        # 聊天功能实现
│   ├── login/       # 登录功能实现
│   └── shop/        # 购物功能实现
├── ui/              # UI文件目录
├── resources/       # 资源文件目录
│   ├── images/      # 图片资源
│   └── styles/      # 样式表
└── tests/           # 测试代码目录
```

### 2.2 核心模块

#### 2.2.1 登录模块（LoginWindow）
- 用户登录
- 用户注册
- 密码找回
- 记住密码功能
- 自动登录功能

#### 2.2.2 购物车模块（ShoppingCart）
- 商品展示
  - 商品图片
  - 商品信息
  - 价格显示
- 数量管理
  - 数量调整
  - 库存检查
- 购物车操作
  - 添加商品
  - 删除商品
  - 批量删除
  - 清空购物车
- 收藏功能
  - 收藏商品
  - 收藏列表
- 数据持久化
  - 本地JSON存储
  - 自动加载保存
- 结算功能
  - 商品选择
  - 总价计算
  - 订单生成

#### 2.2.3 聊天模块（ChatWindow）
- 客服对话
- 消息历史
- 图片发送
- 表情支持

### 2.3 数据流
1. 用户操作 -> GUI界面
2. GUI事件处理 -> 业务逻辑层
3. 业务逻辑层 -> 网络通信层
4. 网络通信层 -> 服务器

## 3. 服务器架构

### 3.1 模块划分
- 用户管理模块
- 商品管理模块
- 订单管理模块
- 支付模块
- 消息模块

### 3.2 数据库设计
- users（用户表）
- products（商品表）
- orders（订单表）
- order_items（订单项表）
- carts（购物车表）
- favorites（收藏表）
- chat_messages（聊天记录表）

## 4. 通信协议

### 4.1 HTTP/REST API
- 用户认证
- 商品操作
- 订单管理

### 4.2 WebSocket
- 实时聊天
- 状态同步
- 消息推送

## 5. 安全设计

### 5.1 用户认证
- JWT令牌认证
- 密码加密存储
- Session管理

### 5.2 数据安全
- HTTPS加密传输
- 敏感数据加密
- SQL注入防护

### 5.3 权限控制
- 用户角色管理
- 访问控制列表
- 操作审计日志

## 6. 扩展性设计

### 6.1 模块化
- 插件式架构
- 接口解耦
- 依赖注入

### 6.2 可伸缩性
- 负载均衡
- 数据库分片
- 缓存机制

## 7. 部署架构

### 7.1 开发环境
- 本地开发环境
- 测试服务器
- CI/CD流水线

### 7.2 生产环境
- 负载均衡服务器
- 应用服务器集群
- 数据库服务器
- 文件存储服务器
- 缓存服务器

## 8. 监控和维护

### 8.1 系统监控
- 性能监控
- 错误日志
- 用户行为分析

### 8.2 运维支持
- 自动化部署
- 系统备份
- 应急响应

## 9. 更新记录

### v1.0.0 (2025-09-19)
- 初始架构设计
- 基础功能实现
  - 登录系统
  - 购物车
  - 客服聊天